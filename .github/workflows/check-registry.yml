name: Check Registry

on:
  pull_request:
    paths:
      - 'registry.json'

jobs:
  check-registry:
    runs-on: ubuntu-latest
    permissions:
      pull-requests: write
    steps:
      - name: Comment and fail
        uses: actions/github-script@v7
        with:
          script: |
            await github.rest.issues.createComment({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: context.issue.number,
              body: `## ⚠️ Please remove \`registry.json\` from this PR

              \`registry.json\` is auto-generated by a workflow after merging — you don't need to include it.

              Please remove it from your branch:
              \`\`\`bash
              git rm --cached registry.json
              echo "registry.json" >> .gitignore  # only if it's not already there
              git commit -m "remove registry.json"
              git push
              \`\`\``,
            });
            core.setFailed('registry.json should not be included in PRs — it is auto-generated by a workflow.');
